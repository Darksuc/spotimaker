<!doctype html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Spotimaker Premium</title>
    <style>
        :root {
            --bg: #0b0b0f;
            --card: #12121a;
            --muted: rgba(255,255,255,.7);
            --text: #fff;
            --line: rgba(255,255,255,.12);
            --accent: #22c55e;
        }

        body {
            font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial;
            max-width: 900px;
            margin: 40px auto;
            padding: 0 16px;
            background: radial-gradient(1100px 520px at 20% 0%, rgba(34,197,94,.14), transparent 55%), radial-gradient(900px 480px at 80% 0%, rgba(59,130,246,.12), transparent 60%), var(--bg);
            color: var(--text);
            animation: fadeIn 0.35s ease-out;
        }

        a {
            color: #fff
        }

        .top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
            margin-bottom: 18px;
            flex-wrap: wrap;
        }

        .btn {
            display: inline-block;
            padding: 10px 12px;
            border-radius: 12px;
            border: 1px solid var(--line);
            text-decoration: none;
            transition: transform .16s ease, box-shadow .18s ease, opacity .18s ease;
        }

            .btn.white {
                background: #fff;
                color: #0b0b0f;
                font-weight: 800;
                border-color: transparent
            }

            .btn:hover {
                transform: translateY(-1px);
                box-shadow: 0 12px 26px rgba(0,0,0,.28);
            }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 14px
        }

        .card {
            background: rgba(18,18,26,.75);
            border: 1px solid var(--line);
            border-radius: 16px;
            padding: 16px;
            animation: fadeUp 0.6s ease-out both;
        }

        .muted {
            color: var(--muted)
        }

        .price {
            font-size: 34px;
            font-weight: 900;
            margin: 8px 0
        }

        ul {
            margin: 10px 0 0 18px
        }

        li {
            margin: 8px 0
        }

        .hero-card {
            display: grid;
            grid-template-columns: 1.2fr 1fr;
            gap: 18px;
            align-items: start;
        }

        .hero-card h1 {
            margin: 0;
        }

        .cta-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 12px;
        }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            border-radius: 999px;
            border: 1px solid var(--line);
            background: rgba(255,255,255,.08);
            font-size: 13px;
        }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @media(max-width:780px) {
            .grid {
                grid-template-columns: 1fr
            }

            .hero-card {
                grid-template-columns: 1fr;
            }
        }

        @media(max-width:640px) {
            body {
                margin: 28px auto;
            }

            .top {
                flex-direction: column;
                align-items: stretch;
            }

            .btn {
                width: 100%;
                text-align: center;
            }

            .cta-row {
                flex-direction: column;
            }

            .grid {
                gap: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="top">
        <a class="btn" href="/">← Geri</a>
        <a class="btn white" href="#" onclick="startCheckout(this); return false;">Premium al</a>
    </div>

    <h1>Premium Early Access</h1>
    <p class="muted">Niyetini anlayan, akışı koruyan ve tek tık alternatifler sunan kürasyon. Erken erişim fiyatı.</p>

    <div id="statusMsg" class="muted" style="margin:10px 0 16px"></div>

    <div id="successBox" class="card" style="display:none; border-color:rgba(34,197,94,.5)">
        <h3>Premium aktif 🎉</h3>
        <p class="muted">Akışı bozmayan, niyet odaklı playlistler ve tek tık alternatifler açıldı.</p>
        <ul>
            <li>Daha akışkan enerji akışı</li>
            <li>Mood + aktivite niyetiyle daha isabetli eşleşme</li>
            <li>Refresh ile aynı vibe’da yeni liste</li>
        </ul>
        <div style="margin-top:12px">
            <a class="btn white" href="/">Playlist oluşturmaya başla</a>
        </div>
    </div>

    <div class="card hero-card" style="margin-top:14px">
        <div>
            <div class="pill">Niyet odaklı kürasyon</div>
            <h1 style="font-size:28px; letter-spacing:-0.3px;">Premium Early Access</h1>
            <p class="muted">Mood + aktivite + tempo niyetini anlayan, akışı bozmadan ilerleyen ve aynı vibe’da alternatif üreten playlistler. Erken erişimdeyiz; gerçek kullanım verisiyle geliştirmeye devam ediyoruz.</p>
            <ul>
                <li>Niyet analizi: “sakin ama ritmik”, “ders odak”, “gece sürüşü” gibi istekleri his + tempo olarak çözümler.</li>
                <li>Akış tasarımı: intro → yükseliş → peak → sakinleşme eğrisiyle doğal enerji.</li>
                <li>Refresh: aynı vibe’dan tek tıkla yeni liste.</li>
                <li>Denge: tanıdık şarkılarla keşfi harmanlar.</li>
            </ul>
            <div class="cta-row">
                <a class="btn white" href="#" onclick="startCheckout(this); return false;">Premium’a geç (₺29.90)</a>
                <a class="btn" href="/">Ana sayfaya dön</a>
            </div>
        </div>
        <div>
            <div class="pill" style="margin-bottom:6px;">30 gün tek sefer</div>
            <div class="price">₺29.90</div>
            <p class="muted">Erken erişim fiyatı. 30 gün boyunca sınırsız üretim ve hızlı yanıt.</p>
            <ul>
                <li>Akıcı enerji akışı ve yüksek isabet</li>
                <li>Tek tıkta alternatif üretme</li>
                <li>200 şarkıya kadar uzun liste</li>
            </ul>
        </div>
    </div>

    <div class="grid">
        <div class="card">
            <h2>Free</h2>
            <div class="price">$0</div>
            <div class="muted">Başlangıç için yeterli.</div>
            <ul>
                <li>Hızlı, tek adım üretim</li>
                <li>Spotify bağlama</li>
                <li>Manuel Spotify'a ekle</li>
                <li>20-40 şarkı arası öneri</li>
            </ul>
        </div>

        <div class="card" style="border-color:rgba(34,197,94,.5)">
            <h2>Premium</h2>
            <div class="price">₺29.90 <span style="font-size:14px;font-weight:700">(30 gün tek sefer)</span></div>
            <div class="muted">Erken erişim fiyatı. 30 gün boyunca sınırsız kullan.</div>
            <ul>
                <li>🎯 Niyet analizi: mood + aktivite + tempo</li>
                <li>🌊 Akış segmentleri: intro → mid → peak → outro</li>
                <li>🔁 Tek tık alternatifler, aynı vibe</li>
                <li>🚫 Tekrarsız: artist üst üste gelmez</li>
            </ul>
            <div style="margin-top:14px">
                <a class="btn white" href="#" onclick="startCheckout(this); return false;">Premium’a geç (₺29.90)</a>
            </div>
        </div>
    </div>

    <div class="card" style="margin-top:14px">
        <h3>Hediye Kodu Kullan</h3>
        <p class="muted">Bir Premium kodun varsa buradan aktive edebilirsin.</p>
        <p class="muted" style="margin-top:6px;">Bu kodlar genellikle erken erişim veya promosyon amaçlıdır.</p>

        <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px">
            <input id="redeemCode" placeholder="Örn: AB3K7Z-123456"
                   style="flex:1; min-width:240px; padding:12px; border-radius:12px; border:1px solid var(--line); background:rgba(255,255,255,.06); color:#fff" />
            <button class="btn white" id="redeemBtn">Kodu Kullan</button>
        </div>

        <div id="redeemMsg" class="muted" style="margin-top:10px"></div>
    </div>

    <div class="card" style="margin-top:14px">
        <h3>SSS</h3>
        <p class="muted"><b>Premium nasıl çalışır?</b> Stripe Checkout ile tek seferlik ödeme yaparsın. Premium 30 gün boyunca aktiftir.</p>
        <p class="muted"><b>İstediğim zaman iptal edebilir miyim?</b> Abonelik değildir. Süre sonunda otomatik olarak sona erer.</p>
    </div>

        <script>
            const statusMsg = document.getElementById("statusMsg");
            const successBox = document.getElementById("successBox");

            const params = new URLSearchParams(location.search);
            if (params.get("success") === "1") {
                statusMsg.textContent = "Premium aktif 🎉";
                if (successBox) successBox.style.display = "block";
            } else if (params.get("canceled") === "1") {
                statusMsg.textContent = "Ödeme iptal edildi.";
            }

            async function startCheckout(btn) {
                try {
                    statusMsg.textContent = "Yönlendiriliyor...";
                    if (btn) btn.disabled = true;
                    const r = await fetch("/api/billing/checkout", {
                        method: "POST",
                        credentials: "include"
                    });
                    const j = await r.json().catch(() => ({}));
                    if (!r.ok || !j.url) throw new Error(j.error || "Stripe oturumu açılamadı.");
                    window.location = j.url;
                } catch (e) {
                    statusMsg.textContent = "❌ " + String(e.message || e);
                } finally {
                    if (btn) btn.disabled = false;
                }
            }

            const btn = document.getElementById("redeemBtn");
            const inp = document.getElementById("redeemCode");
            const msg = document.getElementById("redeemMsg");

            btn.onclick = async () => {
                msg.textContent = "Kontrol ediliyor...";
                btn.disabled = true;
                try {
                    const r = await fetch("/api/redeem", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        credentials: "include",
                        body: JSON.stringify({ code: inp.value })
                    });
                    const j = await r.json().catch(() => ({}));
                    if (!r.ok) throw new Error(j.error || "Kod kullanılamadı.");

                    const d = new Date(j.premium_until);
                    msg.textContent = "✅ Premium aktif! Bitiş: " + d.toLocaleString("tr-TR");
                    setTimeout(() => location.href = "/", 900);
                } catch (e) {
                    msg.textContent = "❌ " + String(e.message || e);
                } finally {
                    btn.disabled = false;
                }
            };
        </script>

    </div>
</body>
</html>
